<h1><%= movie ? 'Edit Movie' : 'Create Movie' %></h1>

<form action="<%= movie ? '/movies/' + movie.film_id + '/edit' : '/movies/create' %>" method="POST">
  <!-- Titel -->
  <div class="mb-3">
    <label for="title" class="form-label">Title</label>
    <input type="text" class="form-control" id="title" name="title"
           value="<%= movie ? movie.title : '' %>" required>
  </div>

  <!-- Description -->
  <div class="mb-3">
    <label for="description" class="form-label">Description</label>
    <textarea class="form-control" id="description" name="description" rows="3"><%= movie ? movie.description : '' %></textarea>
  </div>

  <!-- Release year -->
  <div class="mb-3">
    <label for="release_year" class="form-label">Release Year</label>
    <input type="number" class="form-control" id="release_year" name="release_year"
           value="<%= movie ? movie.release_year : '' %>">
  </div>

  <!-- Language (dropdown) -->
  <div class="mb-3">
    <label for="language_id" class="form-label">Language</label>
    <select class="form-select" id="language_id" name="language_id" required>
      <option value="">-- Select language --</option>
      <option value="1" <%= movie && movie.language_id === 1 ? 'selected' : '' %>>English</option>
      <option value="2" <%= movie && movie.language_id === 2 ? 'selected' : '' %>>Italian</option>
      <option value="3" <%= movie && movie.language_id === 3 ? 'selected' : '' %>>Japanese</option>
      <option value="4" <%= movie && movie.language_id === 4 ? 'selected' : '' %>>Mandarin</option>
      <option value="5" <%= movie && movie.language_id === 5 ? 'selected' : '' %>>French</option>
    </select>
  </div>

  <!-- Rental duration -->
  <div class="mb-3">
    <label for="rental_duration" class="form-label">Rental Duration (days)</label>
    <input type="number" class="form-control" id="rental_duration" name="rental_duration"
           value="<%= movie ? movie.rental_duration : 3 %>" required>
  </div>

  <!-- Rental rate -->
  <div class="mb-3">
    <label for="rental_rate" class="form-label">Rental Rate ($)</label>
    <input type="number" step="0.01" class="form-control" id="rental_rate" name="rental_rate"
           value="<%= movie ? movie.rental_rate : 4.99 %>" required>
  </div>

  <!-- Length -->
  <div class="mb-3">
    <label for="length" class="form-label">Length (minutes)</label>
    <input type="number" class="form-control" id="length" name="length"
           value="<%= movie ? movie.length : '' %>">
  </div>

  <!-- Replacement cost -->
  <div class="mb-3">
    <label for="replacement_cost" class="form-label">Replacement Cost ($)</label>
    <input type="number" step="0.01" class="form-control" id="replacement_cost" name="replacement_cost"
           value="<%= movie ? movie.replacement_cost : 19.99 %>" required>
  </div>

  <!-- Rating -->
  <div class="mb-3">
    <label for="rating" class="form-label">Rating</label>
    <select class="form-select" id="rating" name="rating">
      <option value="">-- Select rating --</option>
      <option value="G" <%= movie && movie.rating === 'G' ? 'selected' : '' %>>G</option>
      <option value="PG" <%= movie && movie.rating === 'PG' ? 'selected' : '' %>>PG</option>
      <option value="PG-13" <%= movie && movie.rating === 'PG-13' ? 'selected' : '' %>>PG-13</option>
      <option value="R" <%= movie && movie.rating === 'R' ? 'selected' : '' %>>R</option>
      <option value="NC-17" <%= movie && movie.rating === 'NC-17' ? 'selected' : '' %>>NC-17</option>
    </select>
  </div>

  <!-- Special features -->
    <div class="mb-3">
    <label class="form-label">Special features</label><br>

    <% 
        // maak een array van selected features (veilig: trim & guard)
        const selectedSF = (movie && movie.special_features) 
        ? movie.special_features.split(',').map(s => s.trim()) 
        : [];
    %>

    <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" id="sfTrailers" name="special_features" value="Trailers"
        <%= selectedSF.includes('Trailers') ? 'checked' : '' %> >
        <label class="form-check-label" for="sfTrailers">Trailers</label>
    </div>

    <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" id="sfCommentaries" name="special_features" value="Commentaries"
        <%= selectedSF.includes('Commentaries') ? 'checked' : '' %> >
        <label class="form-check-label" for="sfCommentaries">Commentaries</label>
    </div>

    <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" id="sfDeleted" name="special_features" value="Deleted Scenes"
        <%= selectedSF.includes('Deleted Scenes') ? 'checked' : '' %> >
        <label class="form-check-label" for="sfDeleted">Deleted Scenes</label>
    </div>

    <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" id="sfBehind" name="special_features" value="Behind the Scenes"
        <%= selectedSF.includes('Behind the Scenes') ? 'checked' : '' %> >
        <label class="form-check-label" for="sfBehind">Behind the Scenes</label>
    </div>
    </div>


  <button type="submit" class="btn btn-success"><%= movie ? 'Update' : 'Create' %></button>
  <a href="/movies" class="btn btn-secondary">Cancel</a>
</form>
